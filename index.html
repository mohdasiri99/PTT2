<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØµØ§Ù†Ø¹ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„Ø°ÙƒÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/gh/gitbrent/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
    
    <style>
        :root {
            --primary: #2c3e50;
            --bg: #f3f4f6;
        }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        
        .container {
            background: white;
            width: 500px;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            text-align: center;
        }

        h2 { color: var(--primary); margin-bottom: 20px; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        
        label { display: block; text-align: right; font-weight: bold; margin-bottom: 5px; color: #555; }
        input, textarea { 
            width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; 
            margin-bottom: 15px; font-family: 'Cairo'; font-size: 14px; box-sizing: border-box;
        }
        textarea { height: 100px; }

        /* Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ù„ÙˆØ§Ù† */
        .theme-selector { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px; }
        .theme-btn { width: 40px; height: 40px; border-radius: 50%; border: 3px solid white; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.2); transition: 0.3s; }
        .theme-btn:hover, .theme-btn.active { transform: scale(1.2); border-color: #333; }

        button.generate-btn {
            background: #d35400; color: white; border: none; padding: 15px 30px; 
            font-size: 18px; font-weight: bold; border-radius: 8px; cursor: pointer; 
            width: 100%; font-family: 'Cairo'; transition: 0.3s;
        }
        button.generate-btn:hover { background: #e67e22; }

    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ“Š ØµØ§Ù†Ø¹ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…ÙŠØ© (PPTX)</h2>
    
    <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯ÙˆØ±Ø© Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ©</label>
    <input type="text" id="courseTitle" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„ÙØ¹Ø§Ù„">

    <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø¨</label>
    <input type="text" id="trainerName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ">

    <label>Ø£Ø¨Ø±Ø² Ù…Ø­Ø§ÙˆØ± Ø§Ù„Ø¯ÙˆØ±Ø© (ÙƒÙ„ Ù…Ø­ÙˆØ± ÙÙŠ Ø³Ø·Ø±)</label>
    <textarea id="coursePoints" placeholder="- Ù…Ù‚Ø¯Ù…Ø© ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„&#10;- Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¬Ù…Ù‡ÙˆØ±&#10;- Ù„ØºØ© Ø§Ù„Ø¬Ø³Ø¯"></textarea>

    <label>Ø§Ø®ØªØ± Ù„ÙˆÙ† Ø§Ù„Ù‚Ø§Ù„Ø¨ (Theme)</label>
    <div class="theme-selector">
        <div class="theme-btn active" style="background:#2c3e50" onclick="setTheme('#2c3e50', this)"></div> <div class="theme-btn" style="background:#c0392b" onclick="setTheme('#c0392b', this)"></div> <div class="theme-btn" style="background:#16a085" onclick="setTheme('#16a085', this)"></div> <div class="theme-btn" style="background:#8e44ad" onclick="setTheme('#8e44ad', this)"></div> </div>

    <button class="generate-btn" onclick="createPPT()">âš¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…ÙŠ</button>
</div>

<script>
    let selectedColor = '#2c3e50'; // Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ

    function setTheme(color, btn) {
        selectedColor = color;
        document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
    }

    function createPPT() {
        // 1. Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ø±Ø¶ Ø¬Ø¯ÙŠØ¯
        let pres = new PptxGenJS();
        pres.layout = 'LAYOUT_16x9'; // Ù…Ù‚Ø§Ø³ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø¹Ø±ÙŠØ¶Ø©
        pres.rtlMode = true; // ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„ÙŠÙ…ÙŠÙ† Ù„Ù„ÙŠØ³Ø§Ø± Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©

        // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø­Ù‚ÙˆÙ„
        let title = document.getElementById('courseTitle').value || 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯ÙˆØ±Ø©';
        let name = document.getElementById('trainerName').value || 'Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø¨';
        let pointsText = document.getElementById('coursePoints').value;
        let points = pointsText.split('\n').filter(line => line.trim() !== '');

        // --- Ø§Ù„Ø´Ø±ÙŠØ­Ø© 1: Ø§Ù„ØºÙ„Ø§Ù ---
        let slide1 = pres.addSlide();
        
        // Ø²Ø®Ø±ÙØ© Ø§Ù„Ø®Ù„ÙÙŠØ© (Ø´Ø±ÙŠØ· Ù…Ù„ÙˆÙ†)
        slide1.addShape(pres.ShapeType.rect, { x: 0, y: 0, w: '100%', h: '1.5', fill: selectedColor });
        slide1.addShape(pres.ShapeType.rect, { x: 0, y: '85%', w: '100%', h: '15%', fill: '#ecf0f1' });

        // Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
        slide1.addText(title, { 
            x: 0.5, y: 2, w: '90%', h: 1.5, 
            fontSize: 44, bold: true, color: selectedColor, align: 'center', fontFace: 'Arial' 
        });

        // Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø¨
        slide1.addText(`Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¯Ø±Ø¨: ${name}`, { 
            x: 0.5, y: 3.5, w: '90%', h: 1, 
            fontSize: 24, color: '#7f8c8d', align: 'center', fontFace: 'Arial' 
        });

        // Ø§Ù„Ø¹Ø§Ù…
        slide1.addText("2026", { 
            x: 0.5, y: 6.5, w: '90%', h: 0.5, 
            fontSize: 18, color: '#95a5a6', align: 'center' 
        });


        // --- Ø§Ù„Ø´Ø±ÙŠØ­Ø© 2: Ø§Ù„Ù…Ø­Ø§ÙˆØ± ---
        let slide2 = pres.addSlide();
        
        // Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø´Ø±ÙŠØ­Ø©
        slide2.addText("Ù…Ø­Ø§ÙˆØ± Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠ", { 
            x: 0.5, y: 0.5, w: '90%', h: 0.8, 
            fontSize: 32, bold: true, color: selectedColor, align: 'right', 
            border: { pt: 0, pb: '3', color: selectedColor } // Ø®Ø· ØªØ­Øª Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
        });

        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ù‚Ø§Ø· (Bullets)
        let bulletItems = points.map(p => ({ text: p, options: { fontSize: 24, breakLine: true, bullet: true, color: '#333333' } }));
        
        if(bulletItems.length > 0) {
            slide2.addText(bulletItems, { x: 0.5, y: 1.8, w: '90%', h: 4, align: 'right', rtl: true });
        } else {
            slide2.addText("Ù„Ù… ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ø­Ø§ÙˆØ±...", { x: 0.5, y: 2, w: '90%', fontSize: 18, color: '#ccc', align: 'center' });
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù„Ù„Ù…Ø­Ø§Ø¶Ø± (Ù…ÙŠØ²Ø© Ø°ÙƒÙŠØ©)
        slide2.addNotes("ØªØ°ÙƒØ± Ø£Ù† ØªÙˆØ²Ø¹ Ø§Ù„ÙˆÙ‚Øª Ø¨Ø§Ù„ØªØ³Ø§ÙˆÙŠ Ø¨ÙŠÙ† Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø­Ø§ÙˆØ±ØŒ ÙˆØ®ØµØµ 10 Ø¯Ù‚Ø§Ø¦Ù‚ Ù„Ù„Ù†Ù‚Ø§Ø´ ÙÙŠ Ù†Ù‡Ø§ÙŠØ© ÙƒÙ„ Ù…Ø­ÙˆØ±.");


        // --- Ø§Ù„Ø´Ø±ÙŠØ­Ø© 3: Ø§Ù„Ø®Ø§ØªÙ…Ø© ---
        let slide3 = pres.addSlide();
        slide3.background = { color: selectedColor }; // Ø®Ù„ÙÙŠØ© Ù…Ù„ÙˆÙ†Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
        
        slide3.addText("Ø´ÙƒØ±Ø§Ù‹ Ù„Ø­Ø³Ù† Ø§Ø³ØªÙ…Ø§Ø¹ÙƒÙ…", { 
            x: 1, y: 2.5, w: '80%', h: 1, 
            fontSize: 48, bold: true, color: 'FFFFFF', align: 'center' 
        });

        slide3.addText("@MOHDASIRI99", { 
            x: 1, y: 4, w: '80%', h: 1, 
            fontSize: 24, color: 'ECF0F1', align: 'center' 
        });

        // Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù
        pres.writeFile({ fileName: `${title}.pptx` });
    }
</script>

</body>
</html>
