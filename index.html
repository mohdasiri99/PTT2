<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØµØ§Ù†Ø¹ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/gh/gitbrent/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
    
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #16a085;
            --accent: #d35400;
            --bg: #f0f2f5;
        }

        body { font-family: 'Cairo', sans-serif; background: var(--bg); margin: 0; padding: 20px; }
        
        .main-container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        h2, h3 { color: var(--primary); margin-top: 0; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        
        .section { margin-bottom: 25px; background: #f9f9f9; padding: 20px; border-radius: 10px; border: 1px solid #eee; }
        
        label { display: block; font-weight: bold; margin-bottom: 5px; color: #555; }
        input, textarea { 
            width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; 
            font-family: 'Cairo'; margin-bottom: 10px; box-sizing: border-box;
        }
        
        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .btn { padding: 12px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-family: 'Cairo'; color: white; transition: 0.3s; }
        .btn-add { background: var(--secondary); width: 100%; margin-top: 10px; }
        .btn-gen { background: var(--accent); font-size: 18px; width: 100%; margin-top: 20px; }
        .btn-del { background: #e74c3c; padding: 5px 10px; font-size: 12px; float: left; }

        /* Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ù„ÙˆØ§Ù† */
        .color-options { display: flex; gap: 10px; margin-top: 10px; }
        .color-btn { width: 35px; height: 35px; border-radius: 50%; border: 3px solid #eee; cursor: pointer; }
        .color-btn.active { border-color: #333; transform: scale(1.1); }

        .slide-card { background: white; padding: 15px; border: 1px solid #ddd; margin-bottom: 10px; border-right: 4px solid var(--primary); border-radius: 5px; }
    </style>
</head>
<body>

<div class="main-container">
    <h2 style="text-align:center;">ğŸ“Š ØµØ§Ù†Ø¹ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ (PPTX)</h2>

    <div class="section">
        <h3>1. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØºÙ„Ø§Ù ÙˆØ§Ù„ØªØ°ÙŠÙŠÙ„</h3>
        <div style="display:flex; gap:10px;">
            <div style="flex:1"><label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ø±Ø¶</label><input type="text" id="pptTitle" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆÙ‚Øª"></div>
            <div style="flex:1"><label>Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø¨</label><input type="text" id="pptTrainer" placeholder="Ø§Ù„Ø§Ø³Ù… Ù„Ù„Ø­Ù‚ÙˆÙ‚"></div>
        </div>
        <div style="display:flex; gap:10px;">
            <div style="flex:1"><label>Ø­Ø³Ø§Ø¨ Ù…Ù†ØµØ© X</label><input type="text" id="pptTwitter" placeholder="@username"></div>
            <div style="flex:1"><label>Ø§Ù„Ø¹Ø§Ù…</label><input type="text" id="pptYear" value="2026"></div>
        </div>
        
        <label>Ù„ÙˆÙ† Ø§Ù„Ø«ÙŠÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ:</label>
        <div class="color-options">
            <div class="color-btn active" style="background:#2c3e50" onclick="setColor('#2c3e50', this)"></div>
            <div class="color-btn" style="background:#16a085" onclick="setColor('#16a085', this)"></div>
            <div class="color-btn" style="background:#c0392b" onclick="setColor('#c0392b', this)"></div>
            <div class="color-btn" style="background:#8e44ad" onclick="setColor('#8e44ad', this)"></div>
            <div class="color-btn" style="background:#2980b9" onclick="setColor('#2980b9', this)"></div>
        </div>
    </div>

    <div class="section">
        <h3>2. Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø´Ø±Ø§Ø¦Ø­</h3>
        
        <div class="slide-card">
            <label>Ø´Ø±ÙŠØ­Ø© Ø§Ù„Ø£Ù‡Ø¯Ø§Ù (Ù†Ù‚Ø§Ø·):</label>
            <textarea id="slideObjectives" style="height:80px" placeholder="- Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø£ÙˆÙ„&#10;- Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø«Ø§Ù†ÙŠ..."></textarea>
        </div>

        <div id="slidesContainer"></div>

        <button class="btn btn-add" onclick="addContentSlide()">+ Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙŠØ­Ø© Ù…Ø­ØªÙˆÙ‰ Ø¬Ø¯ÙŠØ¯Ø©</button>
        <button class="btn btn-add" style="background:#7f8c8d" onclick="addActivitySlide()">+ Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙŠØ­Ø© Ù†Ø´Ø§Ø·</button>
        <button class="btn btn-add" style="background:#f39c12" onclick="addBreakSlide()">+ Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙŠØ­Ø© Ø§Ø³ØªØ±Ø§Ø­Ø©</button>
    </div>

    <button class="btn btn-gen" onclick="generatePPT()">âš¡ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ø¨Ø§ÙˆØ±Ø¨ÙˆÙŠÙ†Øª (.pptx)</button>
</div>

<script>
    let themeColor = '#2c3e50';
    let slideCount = 0;

    function setColor(color, btn) {
        themeColor = color;
        document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
    }

    // Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙŠØ­Ø© Ù…Ø­ØªÙˆÙ‰ Ø¹Ø§Ø¯ÙŠØ©
    function addContentSlide() {
        slideCount++;
        const div = document.createElement('div');
        div.className = 'slide-card';
        div.innerHTML = `
            <button class="btn-del" onclick="this.parentElement.remove()">Ø­Ø°Ù</button>
            <label style="clear:both">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø´Ø±ÙŠØ­Ø© ${slideCount}</label>
            <input type="text" class="slide-title" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹">
            <label>Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Ù†Ù‚Ø·Ø© ÙÙŠ ÙƒÙ„ Ø³Ø·Ø±)</label>
            <textarea class="slide-body" placeholder="Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù‡Ù†Ø§..."></textarea>
            <input type="hidden" class="slide-type" value="content">
        `;
        document.getElementById('slidesContainer').appendChild(div);
    }

    // Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙŠØ­Ø© Ù†Ø´Ø§Ø·
    function addActivitySlide() {
        const div = document.createElement('div');
        div.className = 'slide-card';
        div.style.borderRightColor = '#7f8c8d';
        div.innerHTML = `
            <button class="btn-del" onclick="this.parentElement.remove()">Ø­Ø°Ù</button>
            <label style="clear:both; color:#7f8c8d">ğŸ’¡ Ø´Ø±ÙŠØ­Ø© Ù†Ø´Ø§Ø· ØªØ¯Ø±ÙŠØ¨ÙŠ</label>
            <input type="text" class="slide-title" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù†Ø´Ø§Ø· (Ù…Ø«Ù„Ø§Ù‹: Ø¹ØµÙ Ø°Ù‡Ù†ÙŠ)">
            <input type="text" class="slide-time" placeholder="Ø§Ù„Ù…Ø¯Ø© (Ù…Ø«Ù„Ø§Ù‹: 15 Ø¯Ù‚ÙŠÙ‚Ø©)">
            <textarea class="slide-body" placeholder="ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ù†Ø´Ø§Ø·..."></textarea>
            <input type="hidden" class="slide-type" value="activity">
        `;
        document.getElementById('slidesContainer').appendChild(div);
    }

    // Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙŠØ­Ø© Ø§Ø³ØªØ±Ø§Ø­Ø©
    function addBreakSlide() {
        const div = document.createElement('div');
        div.className = 'slide-card';
        div.style.borderRightColor = '#f39c12';
        div.innerHTML = `
            <button class="btn-del" onclick="this.parentElement.remove()">Ø­Ø°Ù</button>
            <label style="clear:both; color:#f39c12">â˜• Ø´Ø±ÙŠØ­Ø© Ø§Ø³ØªØ±Ø§Ø­Ø©</label>
            <input type="text" class="slide-time" placeholder="Ù…Ø¯Ø© Ø§Ù„Ø§Ø³ØªØ±Ø§Ø­Ø© (Ù…Ø«Ù„Ø§Ù‹: 20 Ø¯Ù‚ÙŠÙ‚Ø©)">
            <input type="hidden" class="slide-type" value="break">
        `;
        document.getElementById('slidesContainer').appendChild(div);
    }

    // --- Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„ØªÙˆÙ„ÙŠØ¯ ---
    function generatePPT() {
        let pres = new PptxGenJS();
        pres.layout = 'LAYOUT_16x9';
        pres.rtlMode = true; // ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ù„ÙƒØ§Ù…Ù„ Ø§Ù„Ø¹Ø±Ø¶

        // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        let title = document.getElementById('pptTitle').value || 'Ø¹Ø±Ø¶ ØªÙ‚Ø¯ÙŠÙ…ÙŠ';
        let trainer = document.getElementById('pptTrainer').value || '';
        let twitter = document.getElementById('pptTwitter').value || '';
        let year = document.getElementById('pptYear').value || '2026';

        // 1. Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø´Ø±ÙŠØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Master Slide) Ù„Ù„ØªØ°ÙŠÙŠÙ„
        // Ù‡Ø°Ø§ Ø³ÙŠØ¶Ù…Ù† Ø¸Ù‡ÙˆØ± Ø§Ù„Ø­Ù‚ÙˆÙ‚ ÙÙŠ ÙƒÙ„ Ø§Ù„Ø´Ø±Ø§Ø¦Ø­
        pres.defineSlideMaster({
            title: 'MASTER_SLIDE',
            background: { color: 'FFFFFF' },
            objects: [
                // Ø®Ø· ÙØ§ØµÙ„ ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„
                { rect: { x: 0, y: '90%', w: '100%', h: '0.05', fill: themeColor } },
                // Ù†Øµ Ø§Ù„Ø­Ù‚ÙˆÙ‚ (ÙŠÙ…ÙŠÙ†)
                { 
                    text: { text: `Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù„Ù…Ø¯Ø±Ø¨: ${trainer}`, options: { fontSize: 10, align: 'right', color: '666666' } }, 
                    x: '55%', y: '92%', w: '40%', h: 0.5 
                },
                // Ù†Øµ ØªÙˆÙŠØªØ± (ÙŠØ³Ø§Ø±)
                { 
                    text: { text: twitter, options: { fontSize: 10, align: 'left', color: '666666' } }, 
                    x: '5%', y: '92%', w: '40%', h: 0.5 
                }
            ]
        });

        // 2. Ø´Ø±ÙŠØ­Ø© Ø§Ù„ØºÙ„Ø§Ù (Cover)
        let slide1 = pres.addSlide();
        // Ø²Ø®Ø±ÙØ©
        slide1.addShape(pres.ShapeType.rect, { x: 0, y: 0, w: '40%', h: '100%', fill: themeColor });
        // Ø§Ù„Ù†ØµÙˆØµ
        slide1.addText(title, { x: '45%', y: '30%', w: '50%', fontSize: 44, bold: true, color: themeColor, align: 'right', rtl: true });
        slide1.addText(`Ø¥Ø¹Ø¯Ø§Ø¯: ${trainer}`, { x: '45%', y: '50%', w: '50%', fontSize: 24, color: '333333', align: 'right', rtl: true });
        slide1.addText(year, { x: '45%', y: '60%', w: '50%', fontSize: 18, color: '777777', align: 'right' });
        
        // Ø£ÙŠÙ‚ÙˆÙ†Ø© ØªÙˆÙŠØªØ± ÙÙŠ Ø§Ù„ØºÙ„Ø§Ù
        if(twitter) {
            slide1.addText(` ${twitter}`, { x: '45%', y: '70%', w: '50%', fontSize: 16, color: themeColor, align: 'right' });
        }


        // 3. Ø´Ø±ÙŠØ­Ø© Ø§Ù„Ø£Ù‡Ø¯Ø§Ù (Objectives)
        let objText = document.getElementById('slideObjectives').value;
        if(objText) {
            let slide = pres.addSlide({ masterName: 'MASTER_SLIDE' });
            addSlideHeader(slide, "Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠ");
            
            let points = objText.split('\n').filter(l => l.trim());
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ù‚Ø§Ø· Ù…Ø¹ Ø¶Ø¨Ø· Ø§Ù„Ø§ØªØ¬Ø§Ù‡
            let items = points.map(p => ({ 
                text: p, 
                options: { fontSize: 24, bullet: { code: '2022' }, color: '333333', breakLine: true, align: 'right', rtl: true } 
            }));
            slide.addText(items, { x: 0.5, y: 1.5, w: '90%', h: 4, align: 'right', rtl: true });
        }

        // 4. Ø´Ø±Ø§Ø¦Ø­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©
        document.querySelectorAll('#slidesContainer > div').forEach(div => {
            let type = div.querySelector('.slide-type').value;
            let slide = pres.addSlide({ masterName: 'MASTER_SLIDE' });

            if(type === 'content') {
                let sTitle = div.querySelector('.slide-title').value || 'Ø¹Ù†ÙˆØ§Ù†';
                let sBody = div.querySelector('.slide-body').value || '';
                
                addSlideHeader(slide, sTitle);
                
                let points = sBody.split('\n').filter(l => l.trim());
                let items = points.map(p => ({ 
                    text: p, 
                    options: { fontSize: 20, bullet: true, color: '333333', breakLine: true, align: 'right', rtl: true } 
                }));
                slide.addText(items, { x: 0.5, y: 1.5, w: '90%', h: 4, align: 'right', rtl: true });
            
            } else if (type === 'activity') {
                let sTitle = div.querySelector('.slide-title').value || 'Ù†Ø´Ø§Ø·';
                let sTime = div.querySelector('.slide-time').value || '';
                let sBody = div.querySelector('.slide-body').value || '';

                slide.background = { color: 'F9F9F9' }; // ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø®Ù„ÙÙŠØ©
                addSlideHeader(slide, "Ù†Ø´Ø§Ø· ØªØ¯Ø±ÙŠØ¨ÙŠ: " + sTitle);
                
                // Ù…Ø±Ø¨Ø¹ Ø§Ù„ÙˆÙ‚Øª
                slide.addText(`â± Ø§Ù„Ø²Ù…Ù†: ${sTime}`, { 
                    x: 0.5, y: 1.5, w: '30%', h: 0.6, 
                    fill: themeColor, color: 'FFFFFF', align: 'center', borderRadius: 10 
                });

                // Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª
                slide.addText(sBody, { x: 0.5, y: 2.5, w: '90%', h: 3, fontSize: 20, color: '333333', align: 'right', rtl: true });

            } else if (type === 'break') {
                let sTime = div.querySelector('.slide-time').value || '15 Ø¯Ù‚ÙŠÙ‚Ø©';
                slide.background = { color: themeColor }; // Ø®Ù„ÙÙŠØ© Ù…Ù„ÙˆÙ†Ø© ÙƒØ§Ù…Ù„Ø©
                
                slide.addText("â˜• Ø§Ø³ØªØ±Ø§Ø­Ø©", { x: 0, y: 2, w: '100%', fontSize: 60, bold: true, color: 'FFFFFF', align: 'center' });
                slide.addText(sTime, { x: 0, y: 4, w: '100%', fontSize: 30, color: 'ECF0F1', align: 'center' });
            }
        });

        // 5. Ø§Ù„Ø®Ø§ØªÙ…Ø©
        let endSlide = pres.addSlide(); // Ø¨Ø¯ÙˆÙ† Ù…Ø§Ø³ØªØ± Ù„Ø£Ù† Ø§Ù„Ø®Ù„ÙÙŠØ© Ù…Ù„ÙˆÙ†Ø©
        endSlide.background = { color: themeColor };
        endSlide.addText("Ø´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ…", { x: 0, y: 2.5, w: '100%', fontSize: 50, bold: true, color: 'FFFFFF', align: 'center' });
        endSlide.addText(twitter, { x: 0, y: 4, w: '100%', fontSize: 24, color: 'ECF0F1', align: 'center' });

        // Ø­ÙØ¸
        pres.writeFile({ fileName: `Ø¹Ø±Ø¶_${title}.pptx` });
    }

    // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø±Ø³Ù… ØªØ±ÙˆÙŠØ³Ø© Ø§Ù„Ø´Ø±ÙŠØ­Ø©
    function addSlideHeader(slide, text) {
        // Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
        slide.addShape(pres.ShapeType.rect, { x: 0, y: 0.3, w: '60%', h: 0.1, fill: themeColor }); // Ø®Ø· Ø²Ø®Ø±ÙÙŠ
        slide.addText(text, { x: 0.5, y: 0.4, w: '90%', fontSize: 32, bold: true, color: themeColor, align: 'right', rtl: true });
    }
</script>

</body>
</html>
